(d2l) cs@cs-desktop:~/project/recognizing_handwritten_digits/c++/transformer$ ./transformer 
res: 
[[-3.87292, -3.87293, -3.87292]
 [0.263575, 0.258322, 0.247539]
 [0.252045, 0.255628, 0.259471]
 [0.263575, 0.263142, 0.262022]
 [0.252045, 0.253146, 0.254822]
 [0.263575, 0.263666, 0.264079]
 [0.252045, 0.252344, 0.253217]
 [0.263575, 0.263719, 0.264291]
 [0.252045, 0.25209, 0.252705]
 [0.263575, 0.263724, 0.264311]
 [0.252045, 0.25201, 0.252543]
 [0.263575, 0.263724, 0.264314]
 [0.252045, 0.251984, 0.252491]
 [0.263575, 0.263724, 0.264314]
 [0.252045, 0.251977, 0.252475]
 [0.263575, 0.263724, 0.264314]]

[[-3.87292, -3.87293, -3.87291]
 [0.263572, 0.258323, 0.247478]
 [0.252049, 0.255613, 0.259479]
 [0.263572, 0.26317, 0.262045]
 [0.252049, 0.253117, 0.254802]
 [0.263572, 0.263697, 0.264113]
 [0.252049, 0.252311, 0.253189]
 [0.263572, 0.26375, 0.264326]
 [0.252049, 0.252056, 0.252674]
 [0.263572, 0.263756, 0.264347]
 [0.252049, 0.251975, 0.252511]
 [0.263572, 0.263756, 0.26435]
 [0.252049, 0.251949, 0.252459]
 [0.263572, 0.263756, 0.26435]
 [0.252049, 0.251942, 0.252443]
 [0.263572, 0.263756, 0.26435]]

loss: 
[[6.84025]]

res grad: 
[[-0.166488, -0.166488, -0.166488]
 [0.0111589, 0.0111005, 0.0109814]
 [0.011031, 0.0110706, 0.0111132]
 [0.0111589, 0.0111541, 0.0111416]
 [0.011031, 0.0110432, 0.0110617]
 [0.0111589, 0.01116, 0.0111645]
 [0.011031, 0.0110343, 0.0110439]
 [0.0111589, 0.0111605, 0.0111669]
 [0.011031, 0.0110315, 0.0110383]
 [0.0111589, 0.0111606, 0.0111671]
 [0.011031, 0.0110306, 0.0110365]
 [0.0111589, 0.0111606, 0.0111672]
 [0.011031, 0.0110303, 0.0110359]
 [0.0111589, 0.0111606, 0.0111672]
 [0.011031, 0.0110303, 0.0110357]
 [0.0111589, 0.0111606, 0.0111672]]

[[-0.166488, -0.166488, -0.166488]
 [0.0111589, 0.0111005, 0.0109807]
 [0.011031, 0.0110704, 0.0111133]
 [0.0111589, 0.0111544, 0.0111418]
 [0.011031, 0.0110428, 0.0110614]
 [0.0111589, 0.0111603, 0.0111649]
 [0.011031, 0.0110339, 0.0110436]
 [0.0111589, 0.0111609, 0.0111673]
 [0.011031, 0.0110311, 0.0110379]
 [0.0111589, 0.011161, 0.0111675]
 [0.011031, 0.0110302, 0.0110361]
 [0.0111589, 0.011161, 0.0111676]
 [0.011031, 0.01103, 0.0110356]
 [0.0111589, 0.011161, 0.0111676]
 [0.011031, 0.0110299, 0.0110354]
 [0.0111589, 0.011161, 0.0111676]]

embs:
[[0, 0.1, 0.2]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]]

[[0, 0.2, 0.3]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]
 [1, 1, 1]]

embs grad:
[[-9.6228e-07, -5.8772e-07, -1.02577e-06]
 [-7.84964e-06, 2.40588e-06, 1.61897e-05]
 [9.10849e-06, 6.4462e-06, -1.87032e-06]
 [-7.84964e-06, -4.81292e-06, -5.72112e-06]
 [9.10849e-06, 1.01713e-05, 5.15702e-06]
 [-7.84964e-06, -5.59642e-06, -8.82309e-06]
 [9.10851e-06, 1.13756e-05, 7.58602e-06]
 [-7.84964e-06, -5.67592e-06, -9.14371e-06]
 [9.10851e-06, 1.17572e-05, 8.36084e-06]
 [-7.84964e-06, -5.68445e-06, -9.17409e-06]
 [9.10851e-06, 1.18779e-05, 8.60593e-06]
 [-7.84966e-06, -5.68442e-06, -9.17839e-06]
 [9.10849e-06, 1.19165e-05, 8.68497e-06]
 [-7.84966e-06, -5.68444e-06, -9.17842e-06]
 [9.10846e-06, 1.19273e-05, 8.70891e-06]
 [-7.84967e-06, -5.68446e-06, -9.17844e-06]]

[[-9.60641e-07, -5.99265e-07, -1.04351e-06]
 [-7.84077e-06, 2.43232e-06, 1.63759e-05]
 [9.0981e-06, 6.51876e-06, -1.89151e-06]
 [-7.84077e-06, -4.86878e-06, -5.78668e-06]
 [9.0981e-06, 1.02862e-05, 5.21861e-06]
 [-7.84077e-06, -5.66127e-06, -8.92413e-06]
 [9.09812e-06, 1.15043e-05, 7.67329e-06]
 [-7.84077e-06, -5.7416e-06, -9.24827e-06]
 [9.09812e-06, 1.189e-05, 8.45708e-06]
 [-7.84077e-06, -5.75034e-06, -9.27919e-06]
 [9.09812e-06, 1.20122e-05, 8.70519e-06]
 [-7.84077e-06, -5.75036e-06, -9.28356e-06]
 [9.09815e-06, 1.20513e-05, 8.7848e-06]
 [-7.84077e-06, -5.75039e-06, -9.28357e-06]
 [9.09813e-06, 1.20624e-05, 8.80914e-06]
 [-7.84077e-06, -5.75038e-06, -9.28358e-06]]